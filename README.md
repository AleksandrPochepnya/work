# UniConverter 1.0 #

## Описание ##

Программа предназначена для конвертации базовых станций из Excel документа в базу данных SQLite. Для установки соответствия между столбцами таблицы Excel и параметрами базовой станции, которые там находятся используются шаблоны.  Подробнее о шаблонах в разделе "Создание шаблонов".

## Средства разработки ##

* Qt 5.9.4;
* MSVC 2015 32-bit;
* Qt Creator 4.5.2.

## Зависимости ##

* QtXlsx - библиотека для работы с *.xlsx файлами.

## Установка ##

* Перед сборкой убедитесь, что на компьютере установлено ПО Inno Setup и в системной переменной PATH указан путь к нему;
* Выполните скрипт BuildInstaller.bat после сборки приложения с конфигурацией Release.
* В установщик включены:
	* Исполняемый файл программы UniConverter.exe;
	* Внешний библиотеки *.dll;
	* Два файла пустой базы данных: stations.db, с которых программа работает по умолчанию и stations_empty.db - база, которая может потребоваться в процессе работы. Оба файла одинаковы. 
* При деинсталляции программы файл настроек, каталог с шаблонами и базы данных не удаляются из каталога установки.

## Шаблоны ##

### Структура ###
Шаблоны хранятся в текстовых файлах в формате JSON. Редактировать шаблон можно как вручную, так и с помощью графического интерфейса пользователя, что предпочтительнее. Пример шаблона находится в файле Docs/template.json.
Структура шаблона:

*  **bsTypes** - список структур, описывающих какие типы базовых станций используются в файле:
	* **pattern** - список слов через точку с запятой. Если хотя бы одно встречается в значении параметра NAME, принимается данный тип БС;
	* **select** - определяет, используется ли данный тип;
	* **type** - тип базовой станции (0 - Unknown; 1- GSM; 2- UMTS; 3 - CDMA; 4 - LTE; 5 - 5G).
* **useSingleBsType** - указывает, что в файле используются базовые станции только одного типа. Тип станции указывается с помощью параметра singleBsType;
* **defaultBsType** - тип базовой станции, который используется  для станция с неопределенных типом (работает, если отключена опция useSingleBsType);
* **firstRow, lastRow** - диапазон строк в таблице Excel, где находятся записи базовых станций (начинается с 1);
* **mapping** - список структур, описывающих соответствие параметров базовой станции и столбцов таблицы Excel):
	* **column** - номер столбца (начинается с 1);
	* **field** - название параметра базовой станции;
	* **default** - значение, которое будет использоваться, если данный параметр не выбран. Доступно только для параметра TURN;
	* **select** - указывает, нужно ли использовать даное поле.

### Создание ###

Все параметры, которые описаны в предыдущем пункте нужно редактировать из интерфейса пользователя. Можно это делать и вручную, но можно ввести неверные значения и это добавит сложности с поиском проблемы.

- Указываем диапазон строк в таблице, где расположены записи о базовых станциях;
- Указываем в каком столбце находится каждый параметр станции (Соответствие столбцов). Если такого нет в таблице убираем галочку и данный параметр не будет считываться.
- Если в таблице станции только одного типа, ставим галочку "Список содержит станции только одного типа" и указываем тип в поле ниже.
- Если типов может быть несколько,  убираем галочку "Список содержит станции только одного типа", отмечаем какие типы станций встречаются и указывает в поле ввода напротив каждого типа строку вида value1;value2;...;valueN. Будет считан параметр NAME и если в нем встречается хотя-бы одно значение value, будет использован данный тип. Если не удалось определить тип, станции будет присвоен "Тип по умолчанию".

Для сохранения шаблона нажмите на кнопку с троиточием возле елемента выбора шаблона. Будет показано меню действий, которые можно выполнить с текущим шаблоном (Сохранить, Сохранить как, Удалить). Выберите Сохранить, если редактируете существующий шаблон или Сохранить как, если хотите сохранить изменения в  шаблон с новым именем.

## Настройки ##
Настройки программы представлены в текстовом файле в формате JSON.

Описание параметров:

* language - язык интерфейса программы (ru, en). По умолчанию - ru;
* database - имя файла базы данных, в которую будут записаны результаты конвертирования;
* lastUsedBsFile - имя файла Excel, который был использовал последним;
* lastUsedTemplate - имя шаблона, который использовался последний раз;
* previewRowsCount, previewColumnsCount - количество строк и столбцов Excel страницы соответственно, которые будут отображаться в таблице предпросмотра справа. По умолчанию 50 и 20 соответственно.
